// main.c
// Simple lexical analyzer in C
// Identifies keywords, operators, identifiers from input.txt
// Very small, easy to run example.

#include <stdio.h>
#include <string.h>
#include <ctype.h>

// list of keywords we care about
const char *keywords[] = {
    "if", "else", "while", "for", "return", "int", "float"
};
const int keyword_count = sizeof(keywords) / sizeof(keywords[0]);

// list of operators we care about
const char *operators[] = {
    "+", "-", "*", "/", "=", "==", "<", ">", "!"
};
const int operator_count = sizeof(operators) / sizeof(operators[0]);

// check if word matches any keyword
int is_keyword(const char *word) {
    for (int i = 0; i < keyword_count; i++) {
        if (strcmp(word, keywords[i]) == 0) {
            return 1;
        }
    }
    return 0;
}

// check if word matches any operator
int is_operator(const char *word) {
    for (int i = 0; i < operator_count; i++) {
        if (strcmp(word, operators[i]) == 0) {
            return 1;
        }
    }
    return 0;
}

// check for simple identifier: starts with letter or underscore, then letters/digits/underscore
int is_identifier(const char *word) {
    if (!(isalpha((unsigned char)word[0]) || word[0] == '_')) {
        return 0;
    }
    for (int i = 1; word[i] != '\0'; i++) {
        if (!(isalnum((unsigned char)word[i]) || word[i] == '_')) {
            return 0;
        }
    }
    return 1;
}

int main() {
    FILE *fp = fopen("input.txt", "r");
    if (fp == NULL) {
        printf("Cannot open input.txt. Make sure it exists.\n");
        return 1;
    }

    char token[100];

    // Read tokens separated by whitespace
    while (fscanf(fp, "%99s", token) == 1) {
        if (is_keyword(token)) {
            printf("KEYWORD: %s\n", token);
        } else if (is_operator(token)) {
            printf("OPERATOR: %s\n", token);
        } else if (is_identifier(token)) {
            printf("IDENTIFIER: %s\n", token);
        } else {
            printf("UNKNOWN: %s\n", token);
        }
    }

    fclose(fp);
    return 0;
}
